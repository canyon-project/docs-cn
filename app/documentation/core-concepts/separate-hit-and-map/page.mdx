import { Callout } from 'nextra/components'

# åˆ†ç¦»hitå’Œmap

åœ¨CIä¸­æ”¶é›†å‚ä¸babelç¼–è¯‘äº§ç”Ÿçš„åˆå§‹è¦†ç›–ç‡æºæ–‡ä»¶

## åŸå› 

1. __æ”¶é›†å®Œæ•´çš„å‚ä¸ç¼–è¯‘æ–‡ä»¶__: åœ¨ç¼–è¯‘åè¿‡ç¨‹ä¸­ï¼Œé€šè¿‡`babel-plugin-canyon`æ’ä»¶ï¼Œåˆ†æè§£æ
æ¯ä¸ªå‚ä¸ç¼–è¯‘æ–‡ä»¶çš„è¦†ç›–åˆå§‹æ–‡ä»¶ï¼Œå¹¶ä¿å­˜è‡³`.canyon_out`æ–‡ä»¶å¤¹ã€‚

2. __æå‰æ”¶é›†ï¼Œå‡è½»å‹åŠ›__: å½“æ‚¨æ²¡æœ‰ä¸ŠæŠ¥åˆå§‹è¦†ç›–ç‡æ–‡ä»¶ï¼ŒUIè‡ªåŠ¨åŒ–æµ‹è¯•ä¸­éƒ½ä¼šä¸ŠæŠ¥è¿™äº›è¦†ç›–ç‡æ–‡ä»¶
è¿™ä¼šäº§ç”Ÿå·¨å¤§çš„ä¼ è¾“å‹åŠ›ã€‚æå‰æ”¶é›†å¯ä»¥å‡å°‘90%ä»¥ä¸Šçš„ä¼ è¾“å‹åŠ›ã€‚

> [!TIP]
>
> è¿™ä¸æ˜¯å¿…é¡»çš„ï¼Œä½†æ˜¯å¦‚æœæ‚¨éœ€è¦å‡†ç¡®ã€ç¨³å®šçš„æ”¶é›†è¦†ç›–ç‡æ•°æ®ï¼Œå¼ºçƒˆå»ºè®®æ‚¨é…ç½®ã€‚

## ä¸ŠæŠ¥åˆå§‹è¦†ç›–ç‡æ•°æ®

babel-plugin-canyonæ’ä»¶åœ¨ç¼–è¯‘æ—¶ä¼šç”Ÿæˆå‚ä¸ç¼–è¯‘æ–‡ä»¶çš„åŸå§‹å‡ºè¦†ç›–ç‡æ–‡ä»¶å¹¶ä¿å­˜è‡³.canyon_outputæ–‡ä»¶å¤¹ï¼Œæˆ‘ä»¬æä¾›äº†canyon-uploaderçš„å‘½ä»¤è¡Œå·¥å…·ï¼Œæ‚¨å¯åœ¨CIä¸­ä¸ŠæŠ¥è‡³CanyonæœåŠ¡ç«¯ï¼Œ
å¯å‚è€ƒä¾‹å­[canyon-babel-template](https://github.com/canyon-project/canyon-babel-template)ğŸŒ°

```yml filename=".github/workflows/report-canyon-output.yml" {19,20} copy
name: Report Canyon Output

jobs:
  report:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v3
      - name: Set up Node.js
        uses: actions/setup-node@v3
        with:
          node-version: '18'  # å¯ä»¥æ ¹æ®é¡¹ç›®éœ€æ±‚ä¿®æ”¹ Node.js ç‰ˆæœ¬
      - name: Install dependencies
        run: npm install
      - name: Generate output
        run: npm run build

      # ä¸ŠæŠ¥ .canyon_output æ–‡ä»¶å†…å®¹
      - name: Report output
        run: canyon-uploader --dsn=https://canyonjs.org
```

## æ›´æ–° babel æ’ä»¶

é…ç½® keepMap é€‰é¡¹ä¸º false

```js filename="babel.config.js" {7} copy
module.exports = {
  plugins: [
    'istanbul',
    [
      'canyon',
      {
        keepMap: false
      }
    ]
  ]
};
```

## å‡†å¤‡å¥½äº†

æ­¤æ—¶æ£€æŸ¥é¡µé¢çš„window.coverageå¯¹è±¡ï¼Œçœ‹æˆªå›¾ã€‚window.coverageä¸­å·²ç»æ²¡æœ‰mapæ•°æ®ï¼Œè¿™æ ·
å¯ä»¥å¤§å¤§å‡è½»UIè‡ªåŠ¨åŒ–è¦†ç›–ç‡æ”¶é›†è¿‡ç¨‹ä¸­çš„å¤§é‡ä¼ è¾“æˆæœ¬ã€‚

![](/jietu1.png)